<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Focus Timer</title>

  <!-- iOS / PWA -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Focus Timer">

  <!-- App Icon -->
  <link rel="apple-touch-icon" sizes="180x180" href="logo.png">
  <link rel="icon" type="image/png" sizes="180x180" href="logo.png">

  <style>
    :root {
      --bg:#0f172a;
      --card:#111827;
      --text:#e5e7eb;
      --muted:#9ca3af;
      --accent:#38bdf8;
      --danger:#ef4444;
      --overlay:rgba(0,0,0,.55);
    }

    * { box-sizing:border-box; font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Inter,sans-serif; }

    body {
      margin:0;
      min-height:100vh;
      background:var(--bg);
      color:var(--text);
      display:flex;
      justify-content:center;
      align-items:center;
    }

    .app { width:100%; max-width:360px; padding:24px; }

    .card {
      background:var(--card);
      border-radius:16px;
      padding:24px;
      box-shadow:0 10px 30px rgba(0,0,0,.4);
    }

    .logo { display:flex; justify-content:center; margin-bottom:16px; }
    .logo img { width:48px; height:48px; opacity:.9; }

    .timer {
      font-size:48px;
      font-weight:600;
      text-align:center;
      margin-bottom:24px;
    }

    .buttons {
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
      margin-bottom:16px;
    }

    button {
      padding:14px;
      border-radius:12px;
      border:none;
      font-size:16px;
      cursor:pointer;
      background:#1f2933;
      color:var(--text);
    }

    button.primary { background:var(--accent); color:#000; }
    button.danger { background:var(--danger); color:#fff; grid-column:span 2; }

    .nav { text-align:center; margin-top:16px; }
    .nav button { background:none; color:var(--muted); font-size:14px; }

    .ledger { display:none; }

    .entry {
      display:flex;
      justify-content:space-between;
      padding:10px 0;
      border-bottom:1px solid #1f2937;
    }

    /* Modal */
    .modal {
      position:fixed;
      inset:0;
      background:var(--overlay);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:10;
    }

    .modal-box {
      background:var(--card);
      border-radius:16px;
      padding:20px;
      width:85%;
      max-width:300px;
      text-align:center;
    }

    .modal-actions { display:flex; gap:10px; margin-top:16px; }

    /* Toast */
    .toast {
      position:fixed;
      bottom:24px;
      left:50%;
      transform:translateX(-50%);
      background:#1f2937;
      padding:12px 20px;
      border-radius:999px;
      font-size:14px;
      opacity:0;
      pointer-events:none;
      transition:.3s;
      z-index:20;
    }

    .toast.show { opacity:1; transform:translateX(-50%) translateY(-6px); }
  </style>
</head>

<body>
  <div class="app">

    <div class="card timer-view">
      <div class="logo"><img src="logo.png"></div>
      <div class="timer" id="timer">00:00:00</div>

      <div class="buttons">
        <button class="primary" id="startPause">Start</button>
        <button id="restart">Restart</button>
        <button class="danger" id="save">Save Session</button>
      </div>

      <div class="nav">
        <button id="viewData">View Data</button>
      </div>
    </div>

    <div class="card ledger">
      <div class="logo"><img src="logo.png"></div>
      <h3>Daily Totals</h3>
      <div id="ledger"></div>
      <div class="nav">
        <button id="back">← Back</button>
      </div>
    </div>
  </div>

  <div class="modal" id="restartModal">
    <div class="modal-box">
      <h4>Restart timer?</h4>
      <p>This will reset the current session.</p>
      <div class="modal-actions">
        <button id="cancelRestart">Cancel</button>
        <button class="danger" id="confirmRestart">Restart</button>
      </div>
    </div>
  </div>

  <div class="toast" id="toast">✓ Session saved</div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {

      let startTime = null;
      let elapsed = 0;
      let running = false;
      let interval = null;

      const timerEl = document.getElementById("timer");
      const startPause = document.getElementById("startPause");
      const toast = document.getElementById("toast");

      function format(ms) {
        const s = Math.floor(ms / 1000);
        return `${String(Math.floor(s/3600)).padStart(2,"0")}:${String(Math.floor((s%3600)/60)).padStart(2,"0")}:${String(s%60).padStart(2,"0")}`;
      }

      function update() {
        timerEl.textContent = format(elapsed + (running ? Date.now() - startTime : 0));
      }

      startPause.onclick = () => {
        if (!running) {
          running = true;
          startTime = Date.now();
          interval = setInterval(update, 500);
          startPause.textContent = "Pause";
        } else {
          running = false;
          elapsed += Date.now() - startTime;
          clearInterval(interval);
          startPause.textContent = "Start";
        }
      };

      document.getElementById("restart").onclick = () => {
        document.getElementById("restartModal").style.display = "flex";
      };

      document.getElementById("cancelRestart").onclick = () => {
        document.getElementById("restartModal").style.display = "none";
      };

      document.getElementById("confirmRestart").onclick = () => {
        running = false;
        elapsed = 0;
        clearInterval(interval);
        startPause.textContent = "Start";
        update();
        document.getElementById("restartModal").style.display = "none";
      };

      document.getElementById("save").onclick = () => {
        const total = elapsed + (running ? Date.now() - startTime : 0);
        if (total < 1000) return;

        const today = new Date().toISOString().slice(0,10);
        const data = JSON.parse(localStorage.getItem("focusData") || "{}");
        data[today] = (data[today] || 0) + total;
        localStorage.setItem("focusData", JSON.stringify(data));

        running = false;
        elapsed = 0;
        clearInterval(interval);
        startPause.textContent = "Start";
        update();

        toast.classList.add("show");
        setTimeout(() => toast.classList.remove("show"), 2000);
      };

      document.getElementById("viewData").onclick = () => {
        const ledger = document.getElementById("ledger");
        ledger.innerHTML = "";
        const data = JSON.parse(localStorage.getItem("focusData") || "{}");
        Object.keys(data).sort().reverse().forEach(d => {
          ledger.innerHTML += `<div class="entry"><span>${d}</span><span>${format(data[d])}</span></div>`;
        });
        document.querySelector(".timer-view").style.display = "none";
        document.querySelector(".ledger").style.display = "block";
      };

      document.getElementById("back").onclick = () => {
        document.querySelector(".ledger").style.display = "none";
        document.querySelector(".timer-view").style.display = "block";
      };

      update();
    });
  </script>
</body>
</html>

